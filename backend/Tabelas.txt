CREATE TABLE endereco (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    cep VARCHAR(9) NOT NULL,
    logradouro VARCHAR(100) NOT NULL,        
    bairro VARCHAR(30) NOT NULL,
    cidade VARCHAR(30) NOT NULL,
    estado CHAR(2) NOT NULL,             
    referencia VARCHAR(50),
    complemento VARCHAR(50)                
);

CREATE TABLE paciente (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nomePaciente VARCHAR(100) NOT NULL,
    cpf VARCHAR(11) NOT NULL UNIQUE,
    data_nascimento DATE NOT NULL,
    genero VARCHAR(20),                      
    contato VARCHAR(20) NOT NULL,
    contato_emergencia VARCHAR(20),         
    tipo_sanguineo VARCHAR(3),              
    alergias TEXT,                           
    endereco_id UUID NOT NULL,
    FOREIGN KEY (endereco_id) REFERENCES endereco(id)
);

CREATE TABLE responsavel(
	id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	nomeResponsavel VARCHAR(100) NOT NULL,
	dataNascResponsavel DATE NOT NULL,
	cartaoSusResponsavel VARCHAR(30) NOT NULL,
	identidadeResponsavel VARCHAR(20) NOT NULL,
    	cpfResponsavel VARCHAR(11) NOT NULL UNIQUE,
	escResponsavel VARCHAR(1) NOT NULL  ,
	naturResponsavel VARCHAR(15) NOT NULL,
	telefoneResponsavel VARCHAR(60) NOT NULL,
	estadoCivilResponsavel INT NOT NULL,
	situacaoProfissionalResponsavel INT NOT NULL,
	salarioResponsavel DECIMAL(10, 2) NOT NULL,
);

CREATE TABLE diagnostico (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    idPaciente UUID NOT NULL,
    idMedico UUID NOT NULL,
    triagem TEXT NOT NULL,
    laudo_medico TEXT NOT NULL,
    grau VARCHAR(8) NOT NULL,     
    cid_principal VARCHAR(10) NOT NULL,
    cid_secundario VARCHAR(10),
    status VARCHAR(20) NOT NULL DEFAULT 'Ativo',  
    data_diagnostico DATE NOT NULL,
    data_atualizacao TIMESTAMP,           
    observacoes TEXT,                 
    FOREIGN KEY (idPaciente) REFERENCES paciente(id),
    FOREIGN KEY (idMedico) REFERENCES medico(id),
);


CREATE TABLE profissional (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nome VARCHAR(100) NOT NULL,
    funcao VARCHAR(50) NOT NULL,
    contato VARCHAR(20) NOT NULL,
    email VARCHAR(100),                
    data_admissao DATE,           
    ativo BOOLEAN DEFAULT TRUE          
);


CREATE TABLE medico (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    profissional_id UUID NOT NULL,
    especializacao VARCHAR(50) NOT NULL,
    crm VARCHAR(20) NOT NULL UNIQUE,
    data_formacao DATE,                  
    instituicao_formacao VARCHAR(100),     
    FOREIGN KEY (profissional_id) REFERENCES profissional(id)
);

CREATE TABLE paciente_profissional (
    paciente_id UUID NOT NULL,
    profissional_id UUID NOT NULL,
    data_vinculo DATE NOT NULL DEFAULT CURRENT_DATE,
    tipo_vinculo VARCHAR(30) NOT NULL,
    PRIMARY KEY (paciente_id, profissional_id),
    FOREIGN KEY (paciente_id) REFERENCES paciente(id),
    FOREIGN KEY (profissional_id) REFERENCES profissional(id)
);